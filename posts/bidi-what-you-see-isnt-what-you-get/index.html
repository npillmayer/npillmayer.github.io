<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Bidi ‚Äì What You See isn&#x27;t What You Get - github.io</title><meta name="description" content="I stumbled across the problem of bidirectional text in terminals while trying to test a variant of the Unicode Bidirectional Algorithm. The Unicode consortium publishes a set of bidi&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://npillmayer.github.io/posts/bidi-what-you-see-isnt-what-you-get/"><link rel="alternate" type="application/atom+xml" href="https://npillmayer.github.io/feed.xml" title="github.io - RSS"><link rel="alternate" type="application/json" href="https://npillmayer.github.io/feed.json" title="github.io - JSON"><meta property="og:title" content="Bidi ‚Äì What You See isn't What You Get"><meta property="og:image" content="https://npillmayer.github.io/media/posts/6/Unicode-Bidi2.png"><meta property="og:image:width" content="771"><meta property="og:image:height" content="739"><meta property="og:site_name" content="github.io"><meta property="og:description" content="I stumbled across the problem of bidirectional text in terminals while trying to test a variant of the Unicode Bidirectional Algorithm. The Unicode consortium publishes a set of bidi&hellip;"><meta property="og:url" content="https://npillmayer.github.io/posts/bidi-what-you-see-isnt-what-you-get/"><meta property="og:type" content="article"><link rel="preload" href="https://npillmayer.github.io/assets/dynamic/fonts/aleo/aleo.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://npillmayer.github.io/assets/css/style.css?v=96b5f3ed26de54ba4369c37700844088"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous"><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.js" integrity="sha384-2B8pfmZZ6JlVoScJm/5hQfNS2TI/6hPqDZInzzPc8oHpN5SgeNOf4LzREO6p5YtZ" crossorigin="anonymous"></script><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://npillmayer.github.io/posts/bidi-what-you-see-isnt-what-you-get/"},"headline":"Bidi ‚Äì What You See isn't What You Get","datePublished":"2021-02-24T15:31+01:00","dateModified":"2026-01-18T16:26+01:00","image":{"@type":"ImageObject","url":"https://npillmayer.github.io/media/posts/6/Unicode-Bidi2.png","height":739,"width":771},"description":"I stumbled across the problem of bidirectional text in terminals while trying to test a variant of the Unicode Bidirectional Algorithm. The Unicode consortium publishes a set of bidi&hellip;","author":{"@type":"Person","name":"Norbert Pillmayer","url":"https://npillmayer.github.io/authors/norbert-pillmayer/"},"publisher":{"@type":"Organization","name":"Norbert Pillmayer","logo":{"@type":"ImageObject","url":"https://npillmayer.github.io/media/website/avatar.png","height":256,"width":256}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><style>.fi{fill:none;stroke-linecap:round;stroke-linejoin:round;vertical-align:middle}</style></head><body class="post-template"><div class="container"><div class="left-bar"><div class="left-bar__inner"><header class="header"><a class="logo" href="https://npillmayer.github.io/"><img src="https://npillmayer.github.io/media/website/avatar.png" alt="github.io" width="256" height="256"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle__box"><span class="navbar__toggle__inner">Menu</span></span></button><ul class="navbar__menu"><li><a class="tltp" href="https://npillmayer.github.io/" target="_self" aria-label="Home"><svg class="fi fi-home" width="24px" height="24px" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><use href="https://npillmayer.github.io/media/plugins/featherIcons/feather-sprite.svg#home"/></svg> <span>Home</span></a></li><li><a class="tltp" href="https://npillmayer.github.io/typography-landing/" target="_self" aria-label="Typography"><svg class="fi fi-type" width="24px" height="24px" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><use href="https://npillmayer.github.io/media/plugins/featherIcons/feather-sprite.svg#type"/></svg> <span>Typography</span></a></li><li><a class="tltp" href="https://npillmayer.github.io/parsers-landing/" target="_self" aria-label="Parsers"><svg class="fi fi-code" width="24px" height="24px" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><use href="https://npillmayer.github.io/media/plugins/featherIcons/feather-sprite.svg#code"/></svg> <span>Parsers</span></a></li><li><a class="tltp" href="https://npillmayer.github.io/tags/" target="_self" aria-label="Topics"><svg class="fi fi-tag" width="24px" height="24px" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><use href="https://npillmayer.github.io/media/plugins/featherIcons/feather-sprite.svg#tag"/></svg> <span>Topics</span></a></li></ul></nav><a class="logo logo--atbottom" href="https://github.com/npillmayer" target="_blank" rel="noopener noreferrer"><img class="tltp" src="https://npillmayer.github.io/media/files//github-logo.png" alt="My GitHub Page" loading="lazy"></a></header></div></div><main class="main post"><article class="content"><figure class="content__featured-image content__featured-image--attop"><img src="https://npillmayer.github.io/media/posts/6/Unicode-Bidi2.png" srcset="https://npillmayer.github.io/media/posts/6/responsive/Unicode-Bidi2-xs.png 320w, https://npillmayer.github.io/media/posts/6/responsive/Unicode-Bidi2-sm.png 480w, https://npillmayer.github.io/media/posts/6/responsive/Unicode-Bidi2-md.png 768w, https://npillmayer.github.io/media/posts/6/responsive/Unicode-Bidi2-xl.png 1024w" sizes="(min-width: 1460px) 938px, (min-width: 1200px) calc(75.83vw - 154px), (min-width: 1120px) 938px, (min-width: 900px) calc(55vw + 333px), 100vw" loading="eager" height="739" width="771" alt="" aria-describedby="image-caption"></figure><div class="content__meta content__meta--attop"><div class="content__meta--attop__inner"><div class="content__maintag"><svg width="20" height="20" aria-hidden="true" focusable="false"><use xlink:href="https://npillmayer.github.io/assets/svg/svg-map.svg#tag"/></svg> Published in <a href="https://npillmayer.github.io/tags/typography/" class="metadata__maintag">Typography</a></div></div></div><div class="main__inner"><div class="content__meta"><div class="content__date"><time datetime="2021-02-24T15:31">Feb 24, 2021</time></div></div><header class="content__header"><h1 class="content__title">Bidi ‚Äì What You See isn&#x27;t What You Get</h1><p class="content__lead">Sometimes tools are too eager to help</p></header><div class="content__entry"><p>I stumbled across the problem of bidirectional text in terminals while trying to test a variant of the <a href="https://www.unicode.org/reports/tr9/" target="_blank" rel="nofollow noopener">Unicode Bidirectional Algorithm</a>. The Unicode consortium publishes a set of bidi test-cases, which suffer from being somewhat ‚Äúnon-visual‚Äù. At the end of the day you want to deal with real sentences in real languages and scripts. Preparing that, you face a peculiar problem: how do you display your test output? After all, UAX#9 is about visual ordering of characters. So we just print it to the terminal, do we? But things get confused quickly.</p><h2 id="how-hard-can-it-be">How Hard can It Be?</h2><p>Sure, terminal applications have to manage some of the messy parts of type, just as browsers do: They need fonts with glyphs for almost any foreseeable script, but restricted to monospace. Text shaping is hard, but probably less so for monospaced fonts. And at least there are no difficulties with sophisticated line breaking, complicated layout with different font sizes, graphics, etc. And bidirectional text should be a solved problem. Or is it?</p><p>Turns out for terminal emulators this is an <a href="https://terminal-wg.pages.freedesktop.org/bidi/bidi-intro/why-terminals-are-special.html" target="_blank" rel="nofollow noopener">especially tricky</a> topic!</p><h2 id="a-conspiracy-to-not-let-you-bidi">A Conspiracy to Not Let You Bidi</h2><p>I started my tests from the <a href="https://github.com/kovidgoyal/kitty" title="kitty terminal project" target="_blank" rel="nofollow noopener">kitty</a> terminal I use on MacOS. Let‚Äôs go small first, with just a single phrase in Hebrew:</p><figure class="illustration400 post__image post__image--center"><img loading="lazy" src="https://npillmayer.github.io/media/posts/6/vte-wikipedia.png" height="630" width="1238" alt="Welcome to Wikipedia (Hebrew)" sizes="(min-width: 760px) 660px, calc(93.18vw - 30px)" srcset="https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-xs.png 320w, https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-sm.png 480w, https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-md.png 768w, https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-xl.png 1024w"></figure><p>This is the output of the original string, prior to any reordering logic from my test. I‚Äôve not been surprised by the output of MacOS Terminal: obviously it recognizes Hebrew script as right-to-left (RTL) and the errorneous positioning of the ‚Äò!‚Äô is a result of me not specifying overall RTL context. But what about kitty? Perhaps I did get the logical (memory) representation of the phrase wrong, so let‚Äôs check by opening it in vim. Surprise: It looks different, depending on the terminal vim runs in. Strange‚Ä¶!</p><p>When working on bidirectional text there is a requirement for text-editors to help developers enter the logical (memory) order of characters, instead of the visual order. Unfortunately only Emacs has an option to turn off interpreting bidi (these days I program in Go on VSCode, and I‚Äôm <a href="https://github.com/microsoft/vscode/issues/83365" target="_blank" rel="nofollow noopener">not alone in my struggles</a>). But shouldn‚Äôt an editor like vim, running in a terminal‚Äôs raw mode, operate independent of what the terminal emulator considers clever behaviour for bidi? Obviously no.</p><h2 id="the-brave-gnome">The Brave Gnome</h2><p>Diving deeper, I read up on <a href="https://ecma-international.org/publications-and-standards/technical-reports/ecma-tr-53/" target="_blank" rel="nofollow noopener">attempts to standardize bidi handling</a>, including in terminal emulators. After all, the majority of the world‚Äôs population use non-Latin scripts, many of them with non-LTR writing direction. But obviously, as of today the behavious of Mac OS Terminal is the best the industry could come up with. And for good reasons: A terminal is not primarily concerned with paragraphs of text, but rather with (from a typesetting perspective) funny combinations of characters, where application of Unicode recommendations simply falls flat.</p><p>A smart guy named Egmont Koblinger, contributor to a lot of stuff around Linux terminals (joe‚Äâ editor, mc‚Äâ file manager, etc.), came up with a proposal for an <a href="https://terminal-wg.pages.freedesktop.org/bidi/" target="_blank" rel="nofollow noopener">updated standard</a> for bidi handling in terminals. It recommends letting applications decide whether they want implicit or explicit bidi handling, the former more or less meaning the Unicode Bidi Algorithm applied by the terminal. When writing tests for bidi yourself, you most certainly prefer explicit mode, i.e., short-curcuiting the terminal‚Äôs cleverness.</p><p>What‚Äôs best: these ideas have already been implemented in <a href="https://wiki.gnome.org/Apps(2f)Terminal(2f)VTE.html" target="_blank" rel="nofollow noopener">VTE</a>, which underlies the Gnome Terminal window. I installed VTE3 on my Mac, included some lines of code in my test to force VTE in explicit mode, and it gave me this:</p><figure class="illustration400 post__image post__image--center"><img loading="lazy" src="https://npillmayer.github.io/media/posts/6/vte-wikipedia-2.png" height="630" width="1238" alt="Hebrew on VTE" sizes="(min-width: 760px) 660px, calc(93.18vw - 30px)" srcset="https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-2-xs.png 320w, https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-2-sm.png 480w, https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-2-md.png 768w, https://npillmayer.github.io/media/posts/6/responsive/vte-wikipedia-2-xl.png 1024w"></figure><p>Now this made me happy üòÑ! VTE shows me the real thing, the characters in logical (memory) order. While this is of no use to an end-user of terminals, I consider it very valuable for application developers, at least those who have to work on the fine points of international text handling. (VTE even has you covered if your intuition about logical order is from right to left.)</p><h2 id="wrap-up">Wrap Up</h2><p>Terminals, text-editors, IDEs and web browsers all conspire to make it hard to develop and test algorithms for handling of international text. But a brave Gnome offers the best of two worlds: a level-headed implicit mode for day-to-day usage, and an explicit mode for bidi-nerds. Thank you!</p><p>I will try to wrap my learnings into a <a href="https://github.com/npillmayer/cords/tree/main/styled/formatter" target="_blank" rel="nofollow noopener">Go package</a>, but at the same time I am aware that this is a tiny niche in a programming universe dominated by web applications, where the browser is expected to do all the heavy lifting. But that‚Äôs a different story.</p></div><footer class="content__footer"><div class="content__last-updated">This article was updated on <time datetime="2026-01-18T16:26">Jan 18, 2026</time></div><div class="content__share"></div></footer></div></article></main><div class="right-bar"><div class="right-bar__inner"><div class="sidebar"><section class="box featured"><h3 class="box__title">Featured Posts</h3><ul class="featured__container"><li class="featured__item"><a href="https://npillmayer.github.io/posts/why-gorgo/" class="featured__image"><img src="https://npillmayer.github.io/media/posts/1/responsive/GoRGO-Logo-small-xs.png" loading="lazy" alt="GoRGO Logo" height="460" width="460"></a><div><a href="https://npillmayer.github.io/posts/why-gorgo/" class="featured__title">Why GoRGO?</a></div></li></ul></section><section class="box tags"><h3 class="box__title">Recommended Topics</h3><ul class="tags__list"><li class="tags__item"><a href="https://npillmayer.github.io/tags/graphics/" class="btn btn--gray">Graphics</a></li><li class="tags__item"><a href="https://npillmayer.github.io/tags/parsing/" class="btn btn--gray">Parsing</a></li><li class="tags__item"><a href="https://npillmayer.github.io/tags/typography/" class="btn btn--gray">Typography</a></li><li class="tags__item"><a href="https://npillmayer.github.io/tags/unicode/" class="btn btn--gray">Unicode</a></li></ul></section><div class="box copyright"><a href="https://www.pillmayer.com/norbert-pillmayer/" target="_blank" rel="noopener noreferrer">¬© Norbert Pillmayer</a></div></div></div></div></div><script defer="defer" src="https://npillmayer.github.io/assets/js/scripts.min.js?v=b2d91bcadbf5db401b76eb5bb3092eb7"></script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>